<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHub Markdown Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/mode-markdown.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/theme-monokai.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/theme-github.js"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      #editor {
        height: 100%;
        width: 100%;
        font-size: 14px;
      }
      .dark-mode {
        color-scheme: dark;
      }
      .markdown-body h1 {
        font-size: 2em;
        padding-bottom: 0.3em;
      }
      .markdown-body h2 {
        font-size: 1.5em;
        padding-bottom: 0.3em;
      }
      .markdown-body h3 {
        font-size: 1.25em;
      }
      .markdown-body h4 {
        font-size: 1em;
      }
      .markdown-body p,
      .markdown-body blockquote,
      .markdown-body ul,
      .markdown-body ol,
      .markdown-body dl,
      .markdown-body table,
      .markdown-body pre {
        margin-bottom: 16px;
      }
      .markdown-body code {
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-size: 85%;
      }
      .markdown-body pre {
        padding: 16px;
        border-radius: 3px;
        overflow: auto;
        line-height: 1.45;
      }
      .markdown-body blockquote {
        padding: 0 1em;
        border-left-width: 4px;
      }
      .markdown-body table {
        border-collapse: collapse;
        width: 100%;
      }
      .markdown-body table th,
      .markdown-body table td {
        padding: 6px 13px;
        border-width: 1px;
      }
      .repo-item:hover .repo-actions {
        display: flex;
      }
      .repo-actions {
        display: none;
      }
    </style>
  </head>
  <body
    class="h-full flex flex-col bg-gray-50 text-gray-900 transition-colors duration-200"
    id="body"
  >
    <!-- GitHub Login Screen -->
    <div
      id="login-screen"
      class="flex items-center justify-center h-full bg-gray-50 dark:bg-gray-900"
    >
      <div class="max-w-md w-full px-6 py-8 bg-white dark:bg-gray-800 shadow-md rounded-lg">
        <div class="text-center mb-8">
          <svg
            class="mx-auto h-12 w-auto text-gray-800 dark:text-white"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path
              d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"
            ></path>
          </svg>
          <h2 class="mt-4 text-2xl font-bold text-gray-900 dark:text-white">
            GitHub Markdown Editor
          </h2>
          <p class="mt-2 text-gray-600 dark:text-gray-400">
            Edit markdown files directly from your GitHub repositories
          </p>
        </div>
        
        <button
          id="github-login-btn"
          class="w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-800 dark:bg-gray-700 hover:bg-gray-700 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
        >
          <svg
            class="h-5 w-5 mr-2"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="white"
          >
            <path
              d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"
            />
          </svg>
          Sign in with GitHub
        </button>
        
        <div class="mt-6">
          <div class="relative">
            <div class="absolute inset-0 flex items-center">
              <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
            </div>
            <div class="relative flex justify-center text-sm">
              <span class="px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400">Or continue with demo</span>
            </div>
          </div>
          
          <button
            id="demo-login-btn"
            class="mt-4 w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
          >
            Try Demo Mode
          </button>
        </div>
      </div>
    </div>

    <!-- Main Application (Initially Hidden) -->
    <div id="app" class="hidden h-full flex flex-col">
      <!-- Navigation Bar -->
      <nav class="bg-white dark:bg-gray-800 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex justify-between h-16">
            <div class="flex items-center">
              <div class="flex-shrink-0 flex items-center">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-8 w-8 text-gray-800 dark:text-gray-200"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"
                  ></path>
                </svg>
                <span
                  class="ml-2 text-xl font-bold text-gray-900 dark:text-white"
                  >MD Editor</span
                >
              </div>
            </div>

            <div class="flex-1 flex items-center justify-center px-6">
              <div id="repo-selector" class="w-full max-w-md relative">
                <button
                  id="repo-dropdown-btn"
                  class="w-full flex items-center justify-between pl-3 pr-10 py-2 text-left bg-white dark:bg-gray-700 rounded-md border border-gray-300 dark:border-gray-600 shadow-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500"
                >
                  <span id="current-repo-name" class="block truncate dark:text-white">Select Repository</span>
                  <span class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </span>
                </button>
                <div
                  id="repo-dropdown-content"
                  class="hidden absolute z-10 mt-1 w-full bg-white dark:bg-gray-800 shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm"
                >
                  <!-- Repository list will be populated here -->
                </div>
              </div>
            </div>

            <div class="flex items-center space-x-4">
              <div id="branch-selector" class="relative hidden">
                <button
                  id="branch-dropdown-btn"
                  class="flex items-center text-sm px-3 py-1 rounded-md border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"
                >
                  <svg class="mr-1.5 h-4 w-4 text-gray-500 dark:text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 3v12"></path>
                    <circle cx="18" cy="6" r="3"></circle>
                    <circle cx="6" cy="18" r="3"></circle>
                    <path d="M18 9a9 9 0 0 1-9 9"></path>
                  </svg>
                  <span id="current-branch">main</span>
                  <svg class="ml-1.5 h-4 w-4 text-gray-500 dark:text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                  </svg>
                </button>
                <div
                  id="branch-dropdown-content"
                  class="hidden absolute right-0 z-10 mt-1 w-48 bg-white dark:bg-gray-800 shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm"
                >
                  <!-- Branch list will be populated here -->
                </div>
              </div>

              <button
                id="theme-toggle"
                class="p-2 rounded-md text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white"
              >
                <svg
                  id="dark-icon"
                  class="h-5 w-5"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                  />
                </svg>
                <svg
                  id="light-icon"
                  class="h-5 w-5 hidden"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                  />
                </svg>
              </button>

              <div class="ml-3 relative">
                <div>
                  <button
                    id="user-menu-button"
                    class="flex items-center space-x-2 text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                  >
                    <img
                      id="user-avatar"
                      class="h-8 w-8 rounded-full"
                      src="/api/placeholder/32/32"
                      alt="User"
                    />
                    <span id="user-name" class="hidden sm:block text-sm font-medium text-gray-700 dark:text-gray-300">User</span>
                  </button>
                </div>
                <div
                  id="user-dropdown"
                  class="hidden origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 z-10"
                >
                  <div class="px-4 py-2 text-sm text-gray-700 dark:text-gray-200 border-b border-gray-200 dark:border-gray-700">
                    <p class="font-medium" id="dropdown-user-name">Username</p>
                    <p class="text-xs text-gray-500 dark:text-gray-400 truncate" id="dropdown-user-email">email@example.com</p>
                  </div>
                  <a
                    href="#"
                    id="logout-btn"
                    class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"
                    >Sign out</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>

      <!-- Main Content -->
      <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar -->
        <aside
          class="w-64 flex-shrink-0 border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex flex-col"
        >
          <div class="p-4 flex flex-col">
            <div class="flex justify-between items-center">
              <h2 class="text-lg font-medium text-gray-900 dark:text-white">
                Files
              </h2>
              <div class="flex space-x-1">
                <button
                  id="refresh-files-btn"
                  class="p-1 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  title="Refresh"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2" />
                  </svg>
                </button>
                <button
                  id="new-file-btn"
                  class="p-1 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"
                  title="New File"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-5 w-5"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z"
                      clip-rule="evenodd"
                    />
                  </svg>
                </button>
              </div>
            </div>
            <div class="mt-2">
              <div class="relative rounded-md shadow-sm">
                <input
                  id="search-input"
                  class="block w-full pl-8 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm text-gray-900 dark:text-white"
                  placeholder="Search files..."
                  type="search"
                />
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <svg class="h-4 w-4 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                  </svg>
                </div>
              </div>
            </div>
          </div>
          <div class="border-t border-gray-200 dark:border-gray-700"></div>
          <div class="overflow-y-auto flex-1">
            <div id="file-path-breadcrumb" class="px-4 py-2 text-sm text-gray-500 dark:text-gray-400"></div>
            <ul id="file-list" class="py-2"></ul>
          </div>
        </aside>

        <!-- Content Area -->
        <div class="flex-1 flex flex-col overflow-hidden">
          <div id="editor-container" class="hidden flex-1 flex flex-col">
            <div
              class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4 flex justify-between items-center"
            >
              <div class="flex items-center space-x-2">
                <input
                  id="file-name-input"
                  class="text-lg font-medium py-1 px-2 border border-transparent rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-transparent text-gray-900 dark:text-white"
                  readonly
                />
                <button
                  id="rename-file-btn"
                  class="p-1 rounded-md text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                  >
                    <path
                      d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"
                    />
                  </svg>
                </button>
              </div>
              <div class="flex space-x-2">
                <div id="commit-container" class="hidden sm:flex items-center mr-2">
                  <input 
                    type="text" 
                    id="commit-message" 
                    placeholder="Commit message" 
                    class="text-sm border border-gray-300 dark:border-gray-600 rounded-md py-1 px-2 w-48 mr-2 dark:bg-gray-700 dark:text-white"
                  >
                </div>
                <button
                  id="save-btn"
                  class="inline-flex items-center px-3 py-1 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                >
                  Commit Changes
                </button>
                <button
                  id="preview-toggle"
                  class="inline-flex items-center px-3 py-1 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                >
                  Preview
                </button>
              </div>
            </div>
            <div class="flex-1 flex overflow-hidden">
              <div id="editor-view" class="flex-1 overflow-hidden"></div>
              <div
                id="preview-view"
                class="hidden flex-1 overflow-y-auto p-6 bg-white dark:bg-gray-800"
              >
                <div
                  id="preview-content"
                  class="markdown-body max-w-3xl mx-auto prose dark:prose-invert"
                ></div>
              </div>
            </div>
          </div>
          <div
            id="welcome-view"
            class="flex-1 flex items-center justify-center p-6 bg-gray-50 dark:bg-gray-900"
          >
            <div class="text-center max-w-md">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-16 w-16 mx-auto text-gray-800 dark:text-gray-200"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"
                ></path>
              </svg>
              <h2 class="mt-4 text-xl font-bold text-gray-900 dark:text-white">
                Select a Repository
              </h2>
              <p class="mt-2 text-gray-600 dark:text-gray-400">
                Choose a repository from the dropdown above to start editing markdown files.
              </p>
              <div id="repo-selection-guide" class="mt-6">
                <button
                  id="repo-selection-btn"
                  class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                >
                  Select Repository
                </button>
              </div>
            </div>
          </div>
          <div
            id="empty-repo-view"
            class="hidden flex-1 flex items-center justify-center p-6 bg-gray-50 dark:bg-gray-900"
          >
            <div class="text-center max-w-md">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-16 w-16 mx-auto text-gray-600 dark:text-gray-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"
                />
              </svg>
              <h2 class="mt-4 text-xl font-bold text-gray-900 dark:text-white">
                No Markdown Files Found
              </h2>
              <p class="mt-2 text-gray-600 dark:text-gray-400">
                This repository doesn't have any markdown files. Create a new markdown file to get started.
              </p>
              <button
                id="create-first-file-btn"
                class="mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
              >
                Create New File
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- New File Modal -->
    <div id="new-file-modal" class="fixed z-10 inset-0 overflow-y-auto hidden">
      <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 transition-opacity" aria-hidden="true">
          <div class="absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"></div>
        </div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
          <div class="bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
            <div class="sm:flex sm:items-start">
              <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900 sm:mx-0 sm:h-10 sm:w-10">
                <svg class="h-6 w-6 text-blue-600 dark:text-blue-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                </svg>
              </div>
              <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">
                  Create New File
                </h3>
                <div class="mt-2">
                  <p class="text-sm text-gray-500 dark:text-gray-400">
                    Enter a name for the new file. The file will be created in the current directory.
                  </p>
                  <div class="mt-4">
                    <input
                      type="text"
                      id="new-file-name"
                      class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 rounded-md p-2 dark:bg-gray-700 dark:text-white"
                      placeholder="filename.md"
                    />
                    <div id="new-file-error" class="mt-1 text-sm text-red-600 hidden"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
            <button
              type="button"
              id="create-file-confirm"
              class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"
            >
              Create
            </button>
            <button
              type="button"
              id="create-file-cancel"
              class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Commit Modal -->
    <div id="commit-modal" class="fixed z-10 inset-0 overflow-y-auto hidden">
      <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 transition-opacity" aria-hidden="true">
          <div class="absolute inset-0 bg-gray-500 dark:bg-gray-900 opacity-75"></div>
        </div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
          <div class="bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
            <div class="sm:flex sm:items-start">
              <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900 sm:mx-0 sm:h-10 sm:w-10">
                <svg class="h-6 w-6 text-green-600 dark:text-green-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
              </div>
              <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">
                  Commit Changes
                </h3>
                <div class="mt-2">
                  <p class="text-sm text-gray-500 dark:text-gray-400">
                    Enter a commit message to describe your changes.
                  </p>
                  <div class="mt-4">
                    <input
                      type="text"
                      id="modal-commit-message"
                      class="shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 dark:border-gray-600 rounded-md p-2 dark:bg-gray-700 dark:text-white"
                      placeholder="Update README.md"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
            <button
              type="button"
              id="commit-confirm"
              class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm"
            >
              Commit
            </button>
            <button
              type="button"
              id="commit-cancel"
              class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 dark:border-gray-600 shadow-sm px-4 py-2 bg-white dark:bg-gray-800 text-base font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 z-50 rounded-md shadow-md p-4 bg-white dark:bg-gray-800 hidden transform transition-all duration-300 opacity-0 translate-y-2">
      <div class="flex items-center">
        <div id="toast-icon-success" class="flex-shrink-0 hidden">
          <svg class="h-6 w-6 text-green-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
        </div>
        <div id="toast-icon-error" class="flex-shrink-0 hidden">
          <svg class="h-6 w-6 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </div>
        <div id="toast-icon-info" class="flex-shrink-0 hidden">
          <svg class="h-6 w-6 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <div id="toast-message" class="ml-3 text-sm font-medium text-gray-900 dark:text-white">
          Action completed successfully!
        </div>
      </div>
    </div>

    <script>
      // Global variables
      let editor;
      let currentFile = null;
      let currentRepo = null;
      let currentBranch = "main";
      let currentPath = "";
      let isFileModified = false;
      let demoRepos = [
        {
          name: "example/markdown-docs",
          description: "Example Markdown Documentation",
          files: [
            {
              name: "README.md",
              path: "README.md",
              content: "# Markdown Documentation\n\nThis is a sample repository for demonstrating the Markdown Editor.\n\n## Features\n\n- **Live Preview**: See your changes as you type\n- **GitHub Flavored**: Supports GitHub Flavored Markdown\n- **Dark Mode**: Easy on the eyes\n- **File Management**: Create, edit, and organize markdown files\n\n## Getting Started\n\nChoose a file from the sidebar to start editing, or create a new file using the + button.\n\n---\n\n*This is a demo repository for the GitHub Markdown Editor.*",
              type: "file"
            },
            {
              name: "guides",
              path: "guides",
              type: "dir",
              children: [
                {
                  name: "getting-started.md",
                  path: "guides/getting-started.md",
                  content: "# Getting Started\n\nWelcome to the Markdown Editor! This guide will help you get started with using the editor.\n\n## Basic Usage\n\n1. **Select a Repository**: Choose a repository from the dropdown menu\n2. **Select a File**: Click on a markdown file in the sidebar to open it\n3. **Edit Content**: Make changes to the file in the editor\n4. **Preview**: Toggle between edit and preview modes\n5. **Save**: Commit your changes with a commit message\n\n## Markdown Basics\n\n### Headers\n\n```markdown\n# Header 1\n## Header 2\n### Header 3\n```\n\n### Lists\n\n```markdown\n- Item 1\n- Item 2\n  - Nested item\n```\n\n### Links\n\n```markdown\n[Link text](https://example.com)\n```\n\n### Images\n\n```markdown\n![Alt text](image-url.jpg)\n```\n\nEnjoy using the Markdown Editor!",
                  type: "file"
                },
                {
                  name: "advanced.md",
                  path: "guides/advanced.md",
                  content: "# Advanced Features\n\n## Code Blocks\n\nCreate code blocks with syntax highlighting:\n\n```javascript\nfunction hello() {\n  console.log('Hello, world!');\n}\n```\n\n## Tables\n\n| Header 1 | Header 2 |\n|----------|----------|\n| Cell 1   | Cell 2   |\n| Cell 3   | Cell 4   |\n\n## Task Lists\n\n- [x] Completed task\n- [ ] Incomplete task\n\n## Footnotes\n\nHere's a sentence with a footnote. [^1]\n\n[^1]: This is the footnote.\n\n## Strikethrough\n\n~~This text is crossed out.~~\n\n## Blockquotes\n\n> This is a blockquote\n> \n> It can span multiple lines",
                  type: "file"
                }
              ]
            },
            {
              name: "examples",
              path: "examples",
              type: "dir",
              children: [
                {
                  name: "example1.md",
                  path: "examples/example1.md",
                  content: "# Example Document\n\nThis is an example of a Markdown document.\n\n## Section 1\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla enim.\n\n## Section 2\n\n- Item 1\n- Item 2\n- Item 3\n\n### Subsection\n\n1. First item\n2. Second item\n3. Third item\n\n## Code Example\n\n```javascript\nfunction greet() {\n  console.log(\"Hello, world!\");\n}\n\ngreet();\n```\n\n## Table\n\n| Name  | Age | Occupation |\n|-------|-----|------------|\n| John  | 32  | Developer  |\n| Sarah | 28  | Designer   |\n| Mike  | 45  | Manager    |\n\n## Links\n\n[GitHub](https://github.com)\n\n## Image\n\n![Markdown Logo](https://markdown-here.com/img/icon256.png)\n\n## Blockquote\n\n> The greatest glory in living lies not in never falling, but in rising every time we fall.\n\n## Horizontal Rule\n\n---\n\n**Bold text** and *italic text*.",
                  type: "file"
                },
                {
                  name: "example2.md",
                  path: "examples/example2.md",
                  content: "# Another Example\n\nThis is another example document to show more Markdown features.\n\n## Math Equations\n\nWhen rendered with a compatible Markdown viewer, the following would show math equations:\n\n```\n$$ E = mc^2 $$\n```\n\n## Diagrams\n\nSome Markdown viewers support diagrams:\n\n```mermaid\ngraph TD;\n    A-->B;\n    A-->C;\n    B-->D;\n    C-->D;\n```\n\n## Emojis\n\nYou can use emoji shortcodes in GitHub Flavored Markdown:\n\n:smile: :heart: :thumbsup: :rocket:\n\n## Keyboard Keys\n\n<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Delete</kbd>\n\n## Abbreviations\n\nHTML is an abbreviation.\n\n*[HTML]: Hyper Text Markup Language\n\n## Definition Lists\n\nTerm 1\n: Definition 1\n\nTerm 2\n: Definition 2a\n: Definition 2b\n\n## Collapsible Sections\n\n<details>\n<summary>Click to expand!</summary>\n\n### Hidden content\n\nThis content is hidden until the section is expanded.\n</details>",
                  type: "file"
                }
              ]
            }
          ]
        },
        {
          name: "example/project-docs",
          description: "Project Documentation",
          files: [
            {
              name: "README.md",
              path: "README.md",
              content: "# Project Documentation\n\nWelcome to the project documentation repository!\n\n## Overview\n\nThis repository contains documentation for the project, including user guides, API references, and developer documentation.\n\n## Navigation\n\n- [User Guide](user-guide.md)\n- [API Reference](api-reference.md)\n- [Developer Documentation](developer-docs.md)\n\n## Contributing\n\nContributions to the documentation are welcome! Please follow the [contribution guidelines](CONTRIBUTING.md).",
              type: "file"
            },
            {
              name: "user-guide.md",
              path: "user-guide.md",
              content: "# User Guide\n\n## Introduction\n\nWelcome to the user guide for our project. This guide will help you get started with using the application.\n\n## Installation\n\n```bash\nnpm install our-project\n```\n\n## Configuration\n\nCreate a configuration file at `config.json` with the following structure:\n\n```json\n{\n  \"apiKey\": \"your-api-key\",\n  \"endpoint\": \"https://api.example.com\",\n  \"timeout\": 5000\n}\n```\n\n## Basic Usage\n\n```javascript\nconst project = require('our-project');\n\nproject.init();\nproject.doSomething();\n```\n\n## Advanced Features\n\n### Feature 1\n\nDescription of feature 1...\n\n### Feature 2\n\nDescription of feature 2...\n\n## Troubleshooting\n\n### Common Issues\n\n- **Issue 1**: Solution for issue 1\n- **Issue 2**: Solution for issue 2\n\n## Support\n\nIf you need help, please [open an issue](https://github.com/example/project/issues).",
              type: "file"
            },
            {
              name: "api-reference.md",
              path: "api-reference.md",
              content: "# API Reference\n\n## Endpoints\n\n### GET /api/items\n\nReturns a list of items.\n\n**Parameters:**\n\n| Name | Type | Description |\n|------|------|-------------|\n| page | integer | Page number |\n| limit | integer | Items per page |\n\n**Response:**\n\n```json\n{\n  \"items\": [\n    {\n      \"id\": 1,\n      \"name\": \"Item 1\",\n      \"description\": \"Description of item 1\"\n    },\n    {\n      \"id\": 2,\n      \"name\": \"Item 2\",\n      \"description\": \"Description of item 2\"\n    }\n  ],\n  \"total\": 10,\n  \"page\": 1,\n  \"limit\": 2\n}\n```\n\n### POST /api/items\n\nCreates a new item.\n\n**Request Body:**\n\n```json\n{\n  \"name\": \"New Item\",\n  \"description\": \"Description of new item\"\n}\n```\n\n**Response:**\n\n```json\n{\n  \"id\": 3,\n  \"name\": \"New Item\",\n  \"description\": \"Description of new item\",\n  \"createdAt\": \"2023-01-01T00:00:00Z\"\n}\n```\n\n## Authentication\n\nAll API endpoints require authentication. Include an `Authorization` header with a Bearer token:\n\n```\nAuthorization: Bearer your-api-token\n```\n\n## Error Handling\n\nErrors are returned as JSON objects with the following structure:\n\n```json\n{\n  \"error\": {\n    \"code\": \"invalid_request\",\n    \"message\": \"Invalid request parameters\"\n  }\n}\n```\n\n## Rate Limiting\n\nAPI requests are limited to 100 requests per minute per IP address.",
              type: "file"
            },
            {
              name: "developer-docs.md",
              path: "developer-docs.md",
              content: "# Developer Documentation\n\n## Project Structure\n\n```\n/src\n  /api\n    - controllers/\n    - models/\n    - routes/\n  /config\n  /utils\n  index.js\n/tests\n/docs\n```\n\n## Development Setup\n\n1. Clone the repository:\n   ```bash\n   git clone https://github.com/example/project.git\n   cd project\n   ```\n\n2. Install dependencies:\n   ```bash\n   npm install\n   ```\n\n3. Set up environment variables:\n   ```bash\n   cp .env.example .env\n   ```\n   Then edit `.env` with your specific configuration.\n\n4. Start the development server:\n   ```bash\n   npm run dev\n   ```\n\n## Testing\n\n```bash\nnpm test\n```\n\nTo run tests with coverage:\n\n```bash\nnpm run test:coverage\n```\n\n## Build\n\n```bash\nnpm run build\n```\n\nThe built files will be in the `dist/` directory.\n\n## Deployment\n\n### Docker\n\n```bash\ndocker build -t project-name .\ndocker run -p 3000:3000 project-name\n```\n\n### Manual Deployment\n\n1. Build the project\n2. Copy the `dist/` directory to your server\n3. Install production dependencies:\n   ```bash\n   npm install --production\n   ```\n4. Start the server:\n   ```bash\n   npm start\n   ```\n\n## Contribution Guidelines\n\n1. Fork the repository\n2. Create a new branch for your feature\n3. Write tests for your feature\n4. Implement your feature\n5. Submit a pull request\n\n## Code Style\n\nWe use ESLint and Prettier to maintain code quality. Run linting with:\n\n```bash\nnpm run lint\n```\n\nFix linting issues automatically:\n\n```bash\nnpm run lint:fix\n```",
              type: "file"
            },
            {
              name: "CONTRIBUTING.md",
              path: "CONTRIBUTING.md",
              content: "# Contributing Guidelines\n\nThank you for your interest in contributing to our project! This document provides guidelines and instructions for contributing.\n\n## Code of Conduct\n\nPlease read and follow our [Code of Conduct](CODE_OF_CONDUCT.md).\n\n## How to Contribute\n\n### Reporting Bugs\n\n- Before submitting a bug report, please check the issue tracker to avoid duplicates\n- Use the bug report template when creating a new issue\n- Include detailed steps to reproduce the bug\n- Include screenshots if applicable\n- Include your environment details (OS, browser, etc.)\n\n### Suggesting Features\n\n- Before submitting a feature request, please check the issue tracker and discussions\n- Use the feature request template when creating a new issue\n- Clearly describe the problem the feature would solve\n- Suggest a solution if possible\n\n### Pull Requests\n\n1. Fork the repository\n2. Create a new branch for your changes\n3. Make your changes\n4. Write or update tests as necessary\n5. Run tests and ensure they pass\n6. Update documentation as necessary\n7. Submit a pull request\n\n### Pull Request Process\n\n1. Update the README.md with details of changes if applicable\n2. Update the docs/ folder with any new documentation\n3. The PR will be merged once it has been reviewed and approved\n\n## Development Setup\n\nSee the [Developer Documentation](developer-docs.md) for detailed setup instructions.\n\n## Style Guidelines\n\n### Code Style\n\n- Follow the coding style already present in the codebase\n- Use meaningful variable and function names\n- Comment your code when necessary\n- Write clear commit messages\n\n### Commit Messages\n\nWe follow the [Conventional Commits](https://www.conventionalcommits.org/) specification:\n\n- `feat`: A new feature\n- `fix`: A bug fix\n- `docs`: Documentation changes\n- `style`: Code style changes (formatting, etc.)\n- `refactor`: Code refactoring\n- `test`: Adding or updating tests\n- `chore`: Maintenance tasks\n\nExample: `feat: add user authentication`\n\n## License\n\nBy contributing, you agree that your contributions will be licensed under the project's license.",
              type: "file"
            }
          ]
        }
      ];
      
      // DOM Elements
      const body = document.getElementById('body');
      const loginScreen = document.getElementById('login-screen');
      const app = document.getElementById('app');
      const editorContainer = document.getElementById('editor-container');
      const welcomeView = document.getElementById('welcome-view');
      const emptyRepoView = document.getElementById('empty-repo-view');
      const fileList = document.getElementById('file-list');
      const repoDropdownBtn = document.getElementById('repo-dropdown-btn');
      const repoDropdownContent = document.getElementById('repo-dropdown-content');
      const currentRepoName = document.getElementById('current-repo-name');
      const fileNameInput = document.getElementById('file-name-input');
      const editorView = document.getElementById('editor-view');
      const previewView = document.getElementById('preview-view');
      const previewContent = document.getElementById('preview-content');
      const previewToggle = document.getElementById('preview-toggle');
      const saveBtn = document.getElementById('save-btn');
      const newFileBtn = document.getElementById('new-file-btn');
      const createFirstFileBtn = document.getElementById('create-first-file-btn');
      const refreshFilesBtn = document.getElementById('refresh-files-btn');
      const searchInput = document.getElementById('search-input');
      const branchSelector = document.getElementById('branch-selector');
      const branchDropdownBtn = document.getElementById('branch-dropdown-btn');
      const branchDropdownContent = document.getElementById('branch-dropdown-content');
      const currentBranchSpan = document.getElementById('current-branch');
      const renameFileBtn = document.getElementById('rename-file-btn');
      const userMenuButton = document.getElementById('user-menu-button');
      const userDropdown = document.getElementById('user-dropdown');
      const logoutBtn = document.getElementById('logout-btn');
      const userAvatar = document.getElementById('user-avatar');
      const userName = document.getElementById('user-name');
      const dropdownUserName = document.getElementById('dropdown-user-name');
      const dropdownUserEmail = document.getElementById('dropdown-user-email');
      const themeToggle = document.getElementById('theme-toggle');
      const darkIcon = document.getElementById('dark-icon');
      const lightIcon = document.getElementById('light-icon');
      const newFileModal = document.getElementById('new-file-modal');
      const newFileNameInput = document.getElementById('new-file-name');
      const newFileError = document.getElementById('new-file-error');
      const createFileConfirm = document.getElementById('create-file-confirm');
      const createFileCancel = document.getElementById('create-file-cancel');
      const commitModal = document.getElementById('commit-modal');
      const modalCommitMessage = document.getElementById('modal-commit-message');
      const commitConfirm = document.getElementById('commit-confirm');
      const commitCancel = document.getElementById('commit-cancel');
      const commitMessage = document.getElementById('commit-message');
      const commitContainer = document.getElementById('commit-container');
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toast-message');
      const toastIconSuccess = document.getElementById('toast-icon-success');
      const toastIconError = document.getElementById('toast-icon-error');
      const toastIconInfo = document.getElementById('toast-icon-info');
      const githubLoginBtn = document.getElementById('github-login-btn');
      const demoLoginBtn = document.getElementById('demo-login-btn');
      const repoSelectionBtn = document.getElementById('repo-selection-btn');
      const rfilePathBreadcumb = document.getElementById('file-path-breadcrumb');

      // Let's implement the GitHub OAuth authentication flow
// Add these script functions after the existing script in the HTML file

document.addEventListener('DOMContentLoaded', function() {
  // Initialize the application
  initApp();
});

function initApp() {
  // Set up event listeners
  setupEventListeners();
  
  // Check if there's a GitHub OAuth code in the URL (for when returning from GitHub auth)
  const urlParams = new URLSearchParams(window.location.search);
  const code = urlParams.get('code');
  
  if (code) {
    // Remove the code from the URL to prevent issues on refresh
    window.history.replaceState({}, document.title, window.location.pathname);
    
    // Handle the GitHub authentication
    handleGitHubAuth(code);
  } else {
    // Check if we have a saved token
    const token = localStorage.getItem('github_token');
    if (token) {
      // We're already authenticated
      authenticateWithToken(token);
    }
  }
}

function setupEventListeners() {
  // Setup GitHub login button
  githubLoginBtn.addEventListener('click', initiateGitHubLogin);
  
  // Setup demo mode button
  demoLoginBtn.addEventListener('click', enterDemoMode);
  
  // Setup repo selection button in welcome view
  repoSelectionBtn.addEventListener('click', function() {
    repoDropdownBtn.click();
  });
  
  // Setup repository dropdown
  repoDropdownBtn.addEventListener('click', toggleRepoDropdown);
  
  // Setup branch dropdown
  branchDropdownBtn.addEventListener('click', toggleBranchDropdown);
  
  // Setup theme toggle
  themeToggle.addEventListener('click', toggleTheme);
  
  // Setup user menu
  userMenuButton.addEventListener('click', toggleUserDropdown);
  
  // Setup logout button
  logoutBtn.addEventListener('click', handleLogout);
  
  // Setup preview toggle
  previewToggle.addEventListener('click', togglePreview);
  
  // Setup save button
  saveBtn.addEventListener('click', saveChanges);
  
  // Setup new file button
  newFileBtn.addEventListener('click', showNewFileModal);
  
  // Setup create first file button
  createFirstFileBtn.addEventListener('click', showNewFileModal);
  
  // Setup refresh files button
  refreshFilesBtn.addEventListener('click', refreshFiles);
  
  // Setup search input
  searchInput.addEventListener('input', filterFiles);
  
  // Setup rename file button
  renameFileBtn.addEventListener('click', toggleFileNameEdit);
  
  // Setup file name input
  fileNameInput.addEventListener('blur', handleFileNameChange);
  fileNameInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
      this.blur();
    }
  });
  
  // Setup modal buttons
  createFileConfirm.addEventListener('click', handleCreateFile);
  createFileCancel.addEventListener('click', closeNewFileModal);
  commitConfirm.addEventListener('click', handleCommitChanges);
  commitCancel.addEventListener('click', closeCommitModal);
  
  // Setup editor change event
  document.addEventListener('editorChanged', function() {
    isFileModified = true;
    document.title = `*${currentFile.name} - MD Editor`;
  });
  
  // Close dropdowns when clicking elsewhere
  document.addEventListener('click', function(e) {
    // If clicking outside the repo dropdown
    if (!e.target.closest('#repo-selector') && repoDropdownContent.classList.contains('block')) {
      repoDropdownContent.classList.replace('block', 'hidden');
    }
    
    // If clicking outside the branch dropdown
    if (!e.target.closest('#branch-selector') && branchDropdownContent.classList.contains('block')) {
      branchDropdownContent.classList.replace('block', 'hidden');
    }
    
    // If clicking outside the user dropdown
    if (!e.target.closest('#user-menu-button') && !e.target.closest('#user-dropdown') && 
        userDropdown.classList.contains('block')) {
      userDropdown.classList.replace('block', 'hidden');
    }
  });
}

// GitHub OAuth Authentication Functions
function initiateGitHubLogin() {
  // GitHub OAuth configuration
  const clientId = 'Ov23liGkKAgdipFL14fp'; // Replace with actual client ID
  const redirectUri = window.location.origin + window.location.pathname;
  const scope = 'repo user';
  
  // Construct the GitHub OAuth URL
  const authUrl = `https://github.com/login/oauth/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&scope=${scope}`;
  
  // Redirect to GitHub for authentication
  window.location.href = authUrl;
}

function handleGitHubAuth(code) {
  // Note: In a real application, you would exchange this code for an access token
  // using a server-side endpoint to keep your client secret secure
  
  // For demo purposes, we'll simulate a successful authentication
  showToast('Authenticating with GitHub...', 'info');
  
  // In a real app, this would be a fetch to your backend that exchanges the code for a token
  // For this demo, we'll simulate a successful authentication after a delay
  setTimeout(() => {
    const mockToken = 'mock_github_token_' + Math.random().toString(36).substring(2);
    localStorage.setItem('github_token', mockToken);
    authenticateWithToken(mockToken);
  }, 1500);
}

function authenticateWithToken(token) {
  // In a real app, we would validate the token and get user info
  // For demo purposes, we'll create a mock user
  const user = {
    login: 'Manojkumbi',
    name: 'Manoj Kumar',
    email: 'manoj@example.com',
    avatar_url: 'https://avatars.githubusercontent.com/u/12345678'
  };
  
  // Update UI to show user info
  updateUserInfo(user);
  
  // Fetch repositories
  fetchUserRepositories(token);
  
  // Show the app UI
  loginScreen.classList.add('hidden');
  app.classList.remove('hidden');
  
  showToast('Successfully logged in!', 'success');
}

function fetchUserRepositories(token) {
  // In a real app, we would fetch the user's repositories from GitHub API
  // For this demo, we'll simulate fetching repositories
  
  // Clear existing repositories
  repoDropdownContent.innerHTML = '';
  
  // Add demo repositories
  const repositories = [
    {
      name: 'Manojkumbi/mdeditor',
      description: 'GitHub Markdown Editor',
      private: false
    },
    {
      name: 'Manojkumbi/project-docs',
      description: 'Project Documentation',
      private: false
    },
    {
      name: 'Manojkumbi/personal-notes',
      description: 'Personal Notes and Documentation',
      private: true
    }
  ];
  
  // Populate the repository dropdown
  repositories.forEach(repo => {
    const repoItem = document.createElement('div');
    repoItem.className = 'px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer repo-item flex justify-between items-center';
    
    const repoInfo = document.createElement('div');
    repoInfo.className = 'flex-1';
    
    const repoName = document.createElement('div');
    repoName.className = 'text-sm font-medium text-gray-900 dark:text-white';
    repoName.textContent = repo.name;
    
    const repoDesc = document.createElement('div');
    repoDesc.className = 'text-xs text-gray-500 dark:text-gray-400 truncate';
    repoDesc.textContent = repo.description;
    
    repoInfo.appendChild(repoName);
    repoInfo.appendChild(repoDesc);
    
    const repoStatus = document.createElement('div');
    repoStatus.className = 'ml-2 flex-shrink-0';
    
    if (repo.private) {
      const lockIcon = document.createElement('svg');
      lockIcon.className = 'h-4 w-4 text-gray-400 dark:text-gray-500';
      lockIcon.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
      lockIcon.setAttribute('viewBox', '0 0 20 20');
      lockIcon.setAttribute('fill', 'currentColor');
      
      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      path.setAttribute('fill-rule', 'evenodd');
      path.setAttribute('d', 'M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z');
      path.setAttribute('clip-rule', 'evenodd');
      
      lockIcon.appendChild(path);
      repoStatus.appendChild(lockIcon);
    }
    
    repoItem.appendChild(repoInfo);
    repoItem.appendChild(repoStatus);
    
    repoItem.addEventListener('click', function() {
      selectRepository(repo.name);
    });
    
    repoDropdownContent.appendChild(repoItem);
  });
}

function selectRepository(repoName) {
  currentRepo = repoName;
  currentRepoName.textContent = repoName;
  repoDropdownContent.classList.replace('block', 'hidden');
  
  // Show loading state
  welcomeView.classList.add('hidden');
  emptyRepoView.classList.add('hidden');
  editorContainer.classList.add('hidden');
  
  // Clear current file path
  currentPath = '';
  
  // Fetch repository branches
  fetchRepositoryBranches(repoName);
  
  // Fetch repository files
  fetchRepositoryFiles(repoName, currentBranch, currentPath);
}

function fetchRepositoryBranches(repoName) {
  // In a real app, we would fetch branches from GitHub API
  // For this demo, we'll simulate fetching branches
  
  // Show branch selector
  branchSelector.classList.remove('hidden');
  
  // Clear existing branches
  branchDropdownContent.innerHTML = '';
  
  // Add demo branches
  const branches = ['main', 'develop', 'feature/new-design'];
  
  // Set current branch
  currentBranch = 'main';
  currentBranchSpan.textContent = currentBranch;
  
  // Populate the branch dropdown
  branches.forEach(branch => {
    const branchItem = document.createElement('div');
    branchItem.className = 'px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer';
    branchItem.textContent = branch;
    
    // Add active branch indicator
    if (branch === currentBranch) {
      branchItem.classList.add('bg-gray-100', 'dark:bg-gray-700');
      
      const checkIcon = document.createElement('span');
      checkIcon.className = 'absolute inset-y-0 right-4 flex items-center';
      
      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      svg.setAttribute('class', 'h-4 w-4 text-indigo-500');
      svg.setAttribute('viewBox', '0 0 20 20');
      svg.setAttribute('fill', 'currentColor');
      
      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      path.setAttribute('fill-rule', 'evenodd');
      path.setAttribute('d', 'M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z');
      path.setAttribute('clip-rule', 'evenodd');
      
      svg.appendChild(path);
      checkIcon.appendChild(svg);
      branchItem.appendChild(checkIcon);
    }
    
    branchItem.addEventListener('click', function() {
      selectBranch(branch);
    });
    
    branchDropdownContent.appendChild(branchItem);
  });
}

function selectBranch(branch) {
  if (branch !== currentBranch) {
    currentBranch = branch;
    currentBranchSpan.textContent = currentBranch;
    branchDropdownContent.classList.replace('block', 'hidden');
    
    // Fetch repository files for the selected branch
    fetchRepositoryFiles(currentRepo, currentBranch, currentPath);
  } else {
    branchDropdownContent.classList.replace('block', 'hidden');
  }
}

function fetchRepositoryFiles(repoName, branch, path) {
  // In a real app, we would fetch files from GitHub API
  // For this demo, we'll use our demo repositories
  
  showToast('Loading repository files...', 'info');
  
  // Simulate API delay
  setTimeout(() => {
    let repo;
    
    // Find the matching demo repo
    if (repoName === 'Manojkumbi/mdeditor') {
      repo = demoRepos[0];
    } else if (repoName === 'Manojkumbi/project-docs') {
      repo = demoRepos[1];
    } else if (repoName === 'Manojkumbi/personal-notes') {
      // Create a new demo repo for personal notes
      repo = {
        name: 'Manojkumbi/personal-notes',
        description: 'Personal Notes and Documentation',
        files: [
          {
            name: 'README.md',
            path: 'README.md',
            content: '# Personal Notes\n\nThis is a private repository for personal notes and documentation.\n\n## Overview\n\nUse this repository to store personal notes, ideas, and reference materials.\n\n## Categories\n\n- [Study Notes](study/README.md)\n- [Project Ideas](ideas/README.md)\n- [Reference Materials](reference/README.md)',
            type: 'file'
          },
          {
            name: 'study',
            path: 'study',
            type: 'dir',
            children: [
              {
                name: 'README.md',
                path: 'study/README.md',
                content: '# Study Notes\n\nThis directory contains study notes on various topics.\n\n## Topics\n\n- [Web Development](web-development.md)\n- [Machine Learning](machine-learning.md)',
                type: 'file'
              },
              {
                name: 'web-development.md',
                path: 'study/web-development.md',
                content: '# Web Development Notes\n\n## HTML\n\n- Semantic HTML elements\n- Accessibility best practices\n\n## CSS\n\n- Flexbox layout\n- CSS Grid\n- CSS Variables\n\n## JavaScript\n\n- ES6+ features\n- Async/await\n- Promises\n\n## Frameworks\n\n- React\n- Vue\n- Angular\n\n## Resources\n\n- MDN Web Docs\n- CSS-Tricks\n- JavaScript.info',
                type: 'file'
              }
            ]
          }
        ]
      };
    }
    
    if (!repo) {
      showToast('Repository not found', 'error');
      return;
    }
    
    // Update breadcrumb
    updateFileBreadcrumb(path);
    
    // Clear file list
    fileList.innerHTML = '';
    
    // Get files at the current path
    let currentFiles = repo.files;
    let pathParts = path.split('/').filter(Boolean);
    
    // Navigate to the current path
    for (let i = 0; i < pathParts.length; i++) {
      let found = false;
      for (let j = 0; j < currentFiles.length; j++) {
        if (currentFiles[j].type === 'dir' && currentFiles[j].name === pathParts[i]) {
          currentFiles = currentFiles[j].children;
          found = true;
          break;
        }
      }
      if (!found) {
        showToast('Path not found', 'error');
        return;
      }
    }
    
    // Check if there are markdown files
    let hasMarkdownFiles = currentFiles.some(file => 
      file.type === 'file' && file.name.toLowerCase().endsWith('.md')
    );
    
    // Show empty state if no markdown files
    if (currentFiles.length === 0 || !hasMarkdownFiles) {
      welcomeView.classList.add('hidden');
      editorContainer.classList.add('hidden');
      emptyRepoView.classList.remove('hidden');
      return;
    }
    
    // Add "up directory" item if we're in a subdirectory
    if (path) {
      const upDirItem = document.createElement('li');
      upDirItem.className = 'flex items-center px-4 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700';
      
      const upDirIcon = document.createElement('div');
      upDirIcon.className = 'flex-shrink-0 mr-2';
      
      const upDirSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      upDirSvg.setAttribute('class', 'h-5 w-5 text-gray-400 dark:text-gray-500');
      upDirSvg.setAttribute('fill', 'none');
      upDirSvg.setAttribute('viewBox', '0 0 24 24');
      upDirSvg.setAttribute('stroke', 'currentColor');
      
      const upDirPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      upDirPath.setAttribute('stroke-linecap', 'round');
      upDirPath.setAttribute('stroke-linejoin', 'round');
      upDirPath.setAttribute('stroke-width', '2');
      upDirPath.setAttribute('d', 'M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z');
      
      upDirSvg.appendChild(upDirPath);
      upDirIcon.appendChild(upDirSvg);
      
      const upDirName = document.createElement('span');
      upDirName.className = 'text-gray-700 dark:text-gray-300';
      upDirName.textContent = '..';
      
      upDirItem.appendChild(upDirIcon);
      upDirItem.appendChild(upDirName);
      
      upDirItem.addEventListener('click', function() {
        const parentPath = path.split('/').slice(0, -1).join('/');
        currentPath = parentPath;
        fetchRepositoryFiles(currentRepo, currentBranch, parentPath);
      });
      
      fileList.appendChild(upDirItem);
    }
    
    // Add directories first
    currentFiles.filter(file => file.type === 'dir').forEach(dir => {
      const dirItem = document.createElement('li');
      dirItem.className = 'flex items-center px-4 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700';
      
      const dirIcon = document.createElement('div');
      dirIcon.className = 'flex-shrink-0 mr-2';
      
      const dirSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      dirSvg.setAttribute('class', 'h-5 w-5 text-gray-400 dark:text-gray-500');
      dirSvg.setAttribute('fill', 'none');
      dirSvg.setAttribute('viewBox', '0 0 24 24');
      dirSvg.setAttribute('stroke', 'currentColor');
      
      const dirPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      dirPath.setAttribute('stroke-linecap', 'round');
      dirPath.setAttribute('stroke-linejoin', 'round');
      dirPath.setAttribute('stroke-width', '2');
      dirPath.setAttribute('d', 'M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z');
      
      dirSvg.appendChild(dirPath);
      dirIcon.appendChild(dirSvg);
      
      const dirName = document.createElement('span');
      dirName.className = 'text-gray-700 dark:text-gray-300';
      dirName.textContent = dir.name;
      
      dirItem.appendChild(dirIcon);
      dirItem.appendChild(dirName);
      
      dirItem.addEventListener('click', function() {
        const newPath = path ? `${path}/${dir.name}` : dir.name;
        currentPath = newPath;
        fetchRepositoryFiles(currentRepo, currentBranch, newPath);
      });
      
      fileList.appendChild(dirItem);
    });
    
    // Then add files
    currentFiles.filter(file => file.type === 'file').forEach(file => {
      const fileItem = document.createElement('li');
      fileItem.className = 'flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700';
      
      const fileContent = document.createElement('div');
      fileContent.className = 'flex items-center';
      
      const fileIcon = document.createElement('div');
      fileIcon.className = 'flex-shrink-0 mr-2';
      
      const fileSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      
      if (file.name.toLowerCase().endsWith('.md')) {
        fileSvg.setAttribute('class', 'h-5 w-5 text-blue-500');
      } else {
        fileSvg.setAttribute('class', 'h-5 w-5 text-gray-400 dark:text-gray-500');
      }
      
      fileSvg.setAttribute('fill', 'none');
      fileSvg.setAttribute('viewBox', '0 0 24 24');
      fileSvg.setAttribute('stroke', 'currentColor');
      
      const filePath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      filePath.setAttribute('stroke-linecap', 'round');
      filePath.setAttribute('stroke-linejoin', 'round');
      filePath.setAttribute('stroke-width', '2');
      filePath.setAttribute('d', 'M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z');
      
      fileSvg.appendChild(filePath);
      fileIcon.appendChild(fileSvg);
      
      const fileName = document.createElement('span');
      fileName.className = 'text-gray-700 dark:text-gray-300';
      fileName.textContent = file.name;
      
      fileContent.appendChild(fileIcon);
      fileContent.appendChild(fileName);
      
      // Create file actions (only visible on hover)
      const fileActions = document.createElement('div');
      fileActions.className = 'repo-actions items-center space-x-2';
      
      if (file.name.toLowerCase().endsWith('.md')) {
        // Edit button
        const editButton = document.createElement('button');
        editButton.className = 'p-1 rounded-md text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200';
        editButton.setAttribute('title', 'Edit');
        
        const editSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        editSvg.setAttribute('class', 'h-4 w-4');
        editSvg.setAttribute('fill', 'none');
        editSvg.setAttribute('viewBox', '0 0 24 24');
        editSvg.setAttribute('stroke', 'currentColor');
        
        const editPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        editPath.setAttribute('stroke-linecap', 'round');
        editPath.setAttribute('stroke-linejoin', 'round');
        editPath.setAttribute('stroke-width', '2');
        editPath.setAttribute('d', 'M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z');
        
        editSvg.appendChild(editPath);
        editButton.appendChild(editSvg);
        
        editButton.addEventListener('click', function(e) {
          e.stopPropagation();
          openFile(file);
        });
        
        fileActions.appendChild(editButton);
      }
      
      fileItem.appendChild(fileContent);
      fileItem.appendChild(fileActions);
      
      fileItem.addEventListener('click', function() {
        if (file.name.toLowerCase().endsWith('.md')) {
          openFile(file);
        } else {
          showToast('Only Markdown files can be edited', 'info');
        }
      });
      
      fileList.appendChild(fileItem);
    });
    
    // Show editor container or welcome view
    welcomeView.classList.add('hidden');
    emptyRepoView.classList.add('hidden');
    
    // If a file was previously open, keep it open
    if (currentFile) {
      editorContainer.classList.remove('hidden');
    } else {
      // Auto-open README.md if it exists
      const readmeFile = currentFiles.find(file => 
        file.type === 'file' && file.name.toLowerCase() === 'readme.md'
      );
      
      if (readmeFile) {
        openFile(readmeFile);
      } else {
        editorContainer.classList.add('hidden');
        welcomeView.classList.remove('hidden');
      }
    }
    
    showToast('Repository loaded successfully', 'success');
  }, 1000);
}

function updateFileBreadcrumb(path) {
  filePathBreadcrumb.innerHTML = '';
  
  // Create root element
  const rootElement = document.createElement('span');
  rootElement.className = 'cursor-pointer hover:text-gray-900 dark:hover:text-white';
  rootElement.textContent = currentRepo.split('/')[1];
  rootElement.addEventListener('click', function() {
    currentPath = '';
    fetchRepositoryFiles(currentRepo, currentBranch, '');
  });
  
  filePathBreadcrumb.appendChild(rootElement);
  
  // Create path elements
  const pathParts = path.split('/').filter(Boolean);
  
  if (pathParts.length > 0) {
    let currentPath = '';
    
    pathParts.forEach((part, index) => {
      // Add separator
      const separator = document.createElement('span');
      separator.className = 'mx-1';
      separator.textContent = '/';
      filePathBreadcrumb.appendChild(separator);
      
      // Add path part
      const pathElement = document.createElement('span');
      
      if (index === pathParts.length - 1) {
        pathElement.className = 'text-gray-900 dark:text-white';
      } else {
        pathElement.className = 'cursor-pointer hover:text-gray-900 dark:hover:text-white';
      }
      
      pathElement.textContent = part;
      
      if (index < pathParts.length - 1) {
        // Update current path
        currentPath = currentPath ? `${currentPath}/${part}` : part;
        
        // Store the path in a closure
        const pathCopy = currentPath;
        
        pathElement.addEventListener('click', function() {
          fetchRepositoryFiles(currentRepo, currentBranch, pathCopy);
        });
      }
      
      filePathBreadcrumb.appendChild(pathElement);
    });
  }
}

function openFile(file) {
  // Set current file
  currentFile = file;
  
  // Set file name in the editor header
  fileNameInput.value = file.name;
  
  // Show editor container
  welcomeView.classList.add('hidden');
  emptyRepoView.classList.add('hidden');
  editorContainer.classList.remove('hidden');
  
  // Initialize or update editor content
  if (!editor) {
    // Create editor instance
    editor = ace.edit(editorView);
    editor.setTheme(isDarkMode() ? 'ace/theme/monokai' : 'ace/theme/github');
    editor.session.setMode('ace/mode/markdown');
    editor.setShowPrintMargin(false);
    editor.renderer.setShowGutter(true);
    editor.session.setUseWrapMode(true);
    
    // Add change event listener
    editor.on('change', function() {
      // Update preview if visible
      if (!previewView.classList.contains('hidden')) {
        updatePreview();
      }
      
      // Dispatch editor changed event
      document.dispatchEvent(new Event('editorChanged'));
    });
  }
  
  // Set editor content
  editor.session.setValue(file.content);
  
  // Reset modification state
  isFileModified = false;
  document.title = `${file.name} - MD Editor`;
  
  // Show commit container
  commitContainer.classList.remove('hidden');
  
  // Update preview if visible
  if (!previewView.classList.contains('hidden')) {
    updatePreview();
  }
}

function updatePreview() {
  // Get editor content
  const content = editor.getValue();
  
  // Render markdown
  previewContent.innerHTML = marked.parse(content);
}

function togglePreview() {
  if (previewView.classList.contains('hidden')) {
    // Show preview
    editorView.classList.add('hidden');
    previewView.classList.remove('hidden');
    previewToggle.textContent = 'Edit';
    
    // Update preview
    updatePreview();
  } else {
    // Show editor
    editorView.classList.remove('hidden');
    previewView.classList.add('hidden');
    previewToggle.textContent = 'Preview';
  }
}

function saveChanges() {
  // Show commit modal
  commitModal.classList.remove('hidden');
  modalCommitMessage.focus();
}

function handleCommitChanges() {
  // Get commit message
  const message = modalCommitMessage.value.trim();
  
  if (!message) {
    // Show error if no commit message
    showToast('Please enter a commit message', 'error');
    return;
  }
  
  // Close commit modal
  closeCommitModal();
  
  // Show loading state
  showToast('Committing changes...', 'info');
  
  // In a real app, we would send a request to GitHub API
  // For this demo, we'll simulate committing changes
  setTimeout(() => {
    // Update file content in our local data
    currentFile.content = editor.getValue();
    
    // Reset modification state
    isFileModified = false;
    document.title = `${currentFile.name} - MD Editor`;
    
    showToast('Changes committed successfully!', 'success');
  }, 1000);
}

function closeCommitModal() {
  commitModal.classList.add('hidden');
  modalCommitMessage.value = '';
}

function handleLogout() {
  // Remove token from localStorage
  localStorage.removeItem('github_token');
  
  // Show login screen
  loginScreen.classList.remove('hidden');
  app.classList.add('hidden');
  
  // Reset state
  currentFile = null;
  currentRepo = null;
  currentBranch = 'main';
  currentPath = '';
  isFileModified = false;
  
  showToast('Logged out successfully', 'success');
}
</script></body></html>